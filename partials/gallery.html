<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/modern-normalize/3.0.1/modern-normalize.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Raleway:wght@700&family=Roboto:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/basiclightbox@5.0.4/dist/basicLightbox.min.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <title>Галерея изображений (Киберпанк) - Руководство по JavaScript</title>
    <style>
        /* Базовые стили для галереи */
        .gallery {
            display: flex;
            /* Используем Flexbox для расположения элементов */
            flex-wrap: wrap;
            /* Разрешаем перенос элементов на новую строку */
            gap: 16px;
            /* Промежуток между элементами */
            list-style: none;
            /* Убираем маркеры списка */
            padding: 24px;
            /* Внутренний отступ контейнера */
            margin: 0 auto;
            /* Центрируем галерею, если есть max-width */
            max-width: 1128px;
            /* Ограничиваем максимальную ширину */
            justify-content: center;
            /* Центрируем элементы по горизонтали */
        }

        .gallery-item {
            /* Расчет ширины для 3 элементов в ряду с учетом промежутка */
            flex-basis: calc((100% - 32px) / 3);
            transition: transform 0.3s ease;
            /* Плавный переход для ховера */
            border-radius: 4px;
            /* Небольшое скругление */
            overflow: hidden;
            /* Скрываем части изображения, выходящие за рамки */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            /* Легкая тень */
        }

        .gallery-item:hover {
            transform: scale(1.03);
            /* Немного увеличиваем при наведении */
        }

        .gallery-link {
            display: block;
            /* Ссылка занимает всю область элемента */
            text-decoration: none;
            /* Убираем подчеркивание */
            height: 100%;
            /* Ссылка растягивается на всю высоту */
        }

        .gallery-image {
            display: block;
            /* Убираем лишний отступ под изображением */
            width: 100%;
            /* Изображение занимает всю ширину */
            height: 200px;
            /* Фиксированная высота для превью */
            object-fit: cover;
            /* Масштабируем изображение, сохраняя пропорции и обрезая лишнее */
        }

        /* Адаптивность (пример для 2 колонок на средних экранах) */
        @media (max-width: 768px) {
            .gallery-item {
                flex-basis: calc((100% - 16px) / 2);
            }
        }

        /* Адаптивность (пример для 1 колонки на маленьких экранах) */
        @media (max-width: 480px) {
            .gallery-item {
                flex-basis: 100%;
            }

            .gallery {
                padding: 16px;
                gap: 16px;
            }
        }

        /* Стили для модального окна basicLightbox (если нужны кастомные) */
        .basicLightbox__placeholder img {
            max-width: 90vw;
            max-height: 90vh;
        }
    </style>
</head>

<body>
    <div id="progress-bar"></div>

    <header>
        <div class="container">
            <button id="theme-toggle">Светлая тема</button>
            <h1>JavaScript: Полное руководство для изучения</h1>
            <nav>
                <ul>
                    <li><a href="../index.html">Главная</a></li>
                    <li><a href="learning_guide.html">Гайд по обучению</a></li>
                    <li><a href="basics.html">Основы</a></li>
                    <li><a href="arrays.html">Массивы</a></li>
                    <li><a href="functions.html">Функции</a></li>
                    <li><a href="loops.html">Циклы</a></li>
                    <li><a href="objects.html">Объекты</a></li>
                    <li><a href="oop-classes.html">ООП и классы</a></li>
                    <li><a href="exercises.html">Упражнения</a></li>
                    <li><a href="projects.html">Проекты</a></li>
                    <li><a href="resources.html">Ресурсы</a></li>
                    <li><a href="dom_summary.html">Памятка по DOM</a></li>
                    <li><a href="gallery.html" class="active">Галерея (Пример)</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <h2 id="галерея-изображений">Создание галереи изображений (Киберпанк)</h2>
        <p>В этом уроке мы создадим интерактивную галерею изображений в стиле киберпанк с возможностью просмотра
            увеличенных версий в модальном окне. Мы будем использовать HTML, CSS, JavaScript и внешнюю библиотеку
            <code>basicLightbox</code>.
        </p>

        <section id="gallery-html-markup" class="fade-in visible">
            <h3>1. HTML-разметка для галереи</h3>
            <p>Сначала нам нужен контейнер в HTML, куда JavaScript будет добавлять элементы галереи. Создадим
                невпорядкований список <code>&lt;ul&gt;</code> с классом <code>gallery</code>.</p>
            <ul class="gallery">
            </ul>
            <p>Пока этот список пуст. Мы наполним его с помощью JavaScript на следующих шагах.</p>
        </section>

        <section id="gallery-image-data" class="fade-in visible">
            <h3>2. Массив изображений (Киберпанк-тематика)</h3>
            <p>Для создания галереи нам нужны данные. Создадим в JavaScript массив объектов. Каждый объект будет
                представлять одно изображение и содержать:</p>
            <ul>
                <li><code>preview</code>: URL маленького изображения для превью в галерее.</li>
                <li><code>original</code>: URL большого изображения для модального окна.</li>
                <li><code>description</code>: Текстовое описание изображения (для атрибута <code>alt</code> и подписи).
                </li>
            </ul>
            <p>Мы используем плейсхолдеры для изображений в стиле киберпанк.</p>
            <p>Пример кода (этот код нужно добавить в ваш файл <code>gallery.js</code>):</p>
            <div class="code-block">
                <pre><code class="language-javascript">// ===== Массив данных для галереи (Киберпанк) =====
// Используем плейсхолдеры с placehold.co для надежности
const images = [
  {
    // preview: ссылка на маленькое изображение (для отображения в сетке галереи)
    preview: 'https://placehold.co/600x400/000020/00ffff?text=Neon+Cityscape+Prev',
    // original: ссылка на большое изображение (для модального окна)
    original: 'https://placehold.co/1280x720/000020/00ffff?text=Neon+Cityscape',
    // description: текстовое описание изображения
    description: 'Неоновый городской пейзаж под дождем',
  },
  {
    preview: 'https://placehold.co/600x400/1a001a/ff00ff?text=Cyborg+Alley+Prev',
    original: 'https://placehold.co/1280x720/1a001a/ff00ff?text=Cyborg+Alley',
    description: 'Киборг в темном переулке',
  },
  {
    preview: 'https://placehold.co/600x400/202020/00ff00?text=Data+Stream+Prev',
    original: 'https://placehold.co/1280x720/202020/00ff00?text=Data+Stream',
    description: 'Поток цифровых данных',
  },
  {
    preview: 'https://placehold.co/600x400/0d0d0d/ff4500?text=Rainy+Streets+Prev',
    original: 'https://placehold.co/1280x720/0d0d0d/ff4500?text=Rainy+Streets',
    description: 'Дождливые улицы мегаполиса ночью',
  },
  {
    preview: 'https://placehold.co/600x400/001f3f/7fdbff?text=Hologram+Ad+Prev',
    original: 'https://placehold.co/1280x720/001f3f/7fdbff?text=Hologram+Ad',
    description: 'Голографическая реклама в городе будущего',
  },
  {
    preview: 'https://placehold.co/600x400/301934/f0e68c?text=Tech+Noir+Prev',
    original: 'https://placehold.co/1280x720/301934/f0e68c?text=Tech+Noir',
    description: 'Атмосфера тек-нуара',
  },
  {
    preview: 'https://placehold.co/600x400/4b0082/ee82ee?text=Cyberpunk+Rider+Prev',
    original: 'https://placehold.co/1280x720/4b0082/ee82ee?text=Cyberpunk+Rider',
    description: 'Гонщик на футуристическом байке',
  },
  {
    preview: 'https://placehold.co/600x400/111111/ffcc00?text=Glitch+Art+Prev',
    original: 'https://placehold.co/1280x720/111111/ffcc00?text=Glitch+Art',
    description: 'Абстрактный глитч-арт',
  },
  {
    preview: 'https://placehold.co/600x400/003366/ccffff?text=Android+Dream+Prev',
    original: 'https://placehold.co/1280x720/003366/ccffff?text=Android+Dream',
    description: 'Задумчивый андроид',
  },
];
// Выведем массив в консоль, чтобы убедиться, что он создан.
// (Этот console.log будет в gallery.js, здесь он для примера)
// console.log("Массив данных images (Киберпанк):", images);
</code></pre>
                <button class="copy-code">Скопировать данные</button>
                <button class="toggle-code">Скрыть код</button>
            </div>
        </section>

        <section id="gallery-markup-creation" class="fade-in visible">
            <h3>3. Создание разметки элементов галереи</h3>
            <p>Теперь, имея данные и контейнер, мы можем динамически создать HTML-разметку для каждого элемента галереи
                и вставить ее на страницу.</p>
            <p>Мы будем использовать:</p>
            <ul>
                <li>Метод массива <code>map()</code> для преобразования каждого объекта из массива <code>images</code> в
                    HTML-строку элемента <code>&lt;li&gt;</code>.</li>
                <li>Шаблонные строки (обратные кавычки `` ` ``) для удобного создания HTML-строк с переменными.</li>
                <li>Деструктуризацию объектов (<code>{ preview, original, description }</code>) для легкого доступа к
                    свойствам объекта внутри <code>map()</code>.</li>
                <li>Метод массива <code>join('')</code> для объединения массива HTML-строк в одну большую строку.</li>
                <li>Свойство <code>innerHTML</code> или метод <code>insertAdjacentHTML</code> для вставки
                    сгенерированной разметки в наш <code>&lt;ul class="gallery"&gt;</code>.</li>
            </ul>
            <p>Пример кода (этот код также нужно добавить в ваш файл <code>gallery.js</code>, после массива
                <code>images</code>):
            </p>
            <div class="code-block">
                <pre><code class="language-javascript">// ===== Создание и добавление разметки галереи =====
// (Этот код должен быть в gallery.js)
// console.log("===== 3. Создание разметки элементов галереи =====");

// Находим наш контейнер галереи &lt;ul class="gallery"&gt; в документе.
const galleryContainer = document.querySelector('.gallery');

// Проверяем, найден ли контейнер (на случай ошибки в HTML).
if (galleryContainer) {
    // console.log("   Контейнер .gallery найден.");

    // Создаем HTML-разметку для всех элементов галереи.
    // 1. Используем map() для перебора массива images.
    //    Для каждого объекта { preview, original, description } в массиве...
    const galleryMarkup = images.map(({ preview, original, description }) => {
        // ...возвращаем строку HTML для элемента &lt;li&gt;, используя шаблонную строку.
        // Внутри строки подставляем нужные значения в атрибуты.
        return `
        &lt;li class="gallery-item"&gt;
          &lt;a class="gallery-link" href="${original}"&gt;
            &lt;img
              class="gallery-image"
              src="${preview}"
              data-source="${original}"
              alt="${description}"
            /&gt;
          &lt;/a&gt;
        &lt;/li&gt;
        `; // Важно: data-source хранит ссылку на БОЛЬШОЕ изображение.
    })
    // 2. Используем join('') для объединения всех созданных строк &lt;li&gt; в одну большую строку HTML.
    .join('');

    // 3. Вставляем всю созданную HTML-разметку внутрь контейнера .gallery.
    // Используем insertAdjacentHTML('beforeend', ...) - это немного эффективнее, чем innerHTML += ...
    galleryContainer.insertAdjacentHTML('beforeend', galleryMarkup);
    // console.log("   Разметка галереи успешно создана и добавлена в DOM.");

} else {
    // Если контейнер .gallery не найден на странице.
    console.error("Ошибка: Контейнер .gallery не найден на странице!");
}
</code></pre>
                <button class="copy-code">Скопировать код</button>
                <button class="toggle-code">Скрыть код</button>
            </div>
            <p>После выполнения этого кода в вашем списке <code>&lt;ul class="gallery"&gt;</code> появятся элементы
                <code>&lt;li&gt;</code> с новыми изображениями.
            </p>
        </section>

        <section id="gallery-styling" class="fade-in visible">
            <h3>4. Стилизация галереи</h3>
            <p>Чтобы галерея выглядела аккуратно, добавим CSS-стили. Мы можем разместить их в теге
                <code>&lt;style&gt;</code> внутри <code>&lt;head&gt;</code> нашего HTML или, что предпочтительнее для
                больших проектов, в отдельном CSS-файле (например, <code>../css/style.css</code>), который мы уже
                подключили.
            </p>
            <p>Основные идеи стилизации:</p>
            <ul>
                <li>Использовать <code>display: flex</code> и <code>flex-wrap: wrap</code> для контейнера
                    <code>.gallery</code>, чтобы элементы располагались в ряд и переносились на новую строку.
                </li>
                <li>Задать базовую ширину для <code>.gallery-item</code> с помощью <code>flex-basis</code> (например,
                    для 3 колонок с отступом <code>gap: 16px</code>: <code>calc((100% - 32px) / 3)</code>).</li>
                <li>Использовать <code>object-fit: cover;</code> для <code>.gallery-image</code>, чтобы изображение
                    заполняло контейнер, сохраняя пропорции и обрезая лишнее.</li>
                <li>Добавить медиа-запросы (<code>@media</code>) для адаптивности (например, 2 колонки на планшетах, 1
                    на мобильных).</li>
                <li>Добавить эффект при наведении (<code>:hover</code>) для интерактивности.</li>
            </ul>
            <p>Пример CSS (этот код уже добавлен в <code>&lt;style&gt;</code> в шапке этого HTML-файла, но лучше
                перенести его в <code>../css/style.css</code>):</p>
            <div class="code-block">
                <pre><code class="language-css">/* Базовые стили для галереи */
.gallery {
  display: flex; /* Используем Flexbox для расположения элементов */
  flex-wrap: wrap; /* Разрешаем перенос элементов на новую строку */
  gap: 16px; /* Промежуток между элементами */
  list-style: none; /* Убираем маркеры списка */
  padding: 24px; /* Внутренний отступ контейнера */
  margin: 0 auto; /* Центрируем галерею, если есть max-width */
  max-width: 1128px; /* Ограничиваем максимальную ширину */
  justify-content: center; /* Центрируем элементы по горизонтали */
}

.gallery-item {
  /* Расчет ширины для 3 элементов в ряду с учетом промежутка */
  flex-basis: calc((100% - 32px) / 3);
  transition: transform 0.3s ease; /* Плавный переход для ховера */
  border-radius: 4px; /* Небольшое скругление */
  overflow: hidden; /* Скрываем части изображения, выходящие за рамки */
  box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Легкая тень */
}
.gallery-item:hover {
    transform: scale(1.03); /* Немного увеличиваем при наведении */
}

.gallery-link {
  display: block; /* Ссылка занимает всю область элемента */
  text-decoration: none; /* Убираем подчеркивание */
  height: 100%; /* Ссылка растягивается на всю высоту */
}

.gallery-image {
  display: block; /* Убираем лишний отступ под изображением */
  width: 100%; /* Изображение занимает всю ширину */
  height: 200px; /* Фиксированная высота для превью */
  object-fit: cover; /* Масштабируем изображение, сохраняя пропорции и обрезая лишнее */
}

/* Адаптивность (пример для 2 колонок на средних экранах) */
@media (max-width: 768px) {
    .gallery-item { flex-basis: calc((100% - 16px) / 2); }
}
/* Адаптивность (пример для 1 колонки на маленьких экранах) */
@media (max-width: 480px) {
    .gallery-item { flex-basis: 100%; }
    .gallery { padding: 16px; gap: 16px; }
}
/* Стили для модального окна basicLightbox (если нужны кастомные) */
.basicLightbox__placeholder img {
    max-width: 90vw; /* Ограничиваем ширину изображения в модалке */
    max-height: 90vh; /* Ограничиваем высоту изображения в модалке */
}
</code></pre>
                <button class="copy-code">Скопировать CSS</button>
                <button class="toggle-code">Скрыть код</button>
            </div>
        </section>

        <section id="gallery-event-delegation" class="fade-in visible">
            <h3>5. Делегирование событий для кликов</h3>
            <p>Чтобы отслеживать клики на изображениях галереи, мы не будем добавлять слушатель событий на каждый
                элемент <code>&lt;li&gt;</code> или <code>&lt;img&gt;</code> (это неэффективно, особенно для больших
                галерей). Вместо этого используем <strong>делегирование событий</strong>.</p>
            <p>Идея делегирования:</p>
            <ol>
                <li>Добавляем <strong>один</strong> слушатель событий (например, <code>'click'</code>) на общего предка
                    всех элементов галереи — наш контейнер <code>&lt;ul class="gallery"&gt;</code>.</li>
                <li>Когда происходит клик внутри контейнера, событие "всплывает" вверх по DOM-дереву и достигает нашего
                    контейнера <code>&lt;ul&gt;</code>, где срабатывает слушатель.</li>
                <li>Внутри обработчика события мы проверяем <strong>цель события</strong> (<code>event.target</code>) —
                    элемент, на котором изначально произошел клик.</li>
                <li>Мы проверяем, был ли клик именно на элементе изображения
                    (<code>&lt;img class="gallery-image"&gt;</code>). Используем метод
                    <code>event.target.closest('.gallery-image')</code> для надежности.
                </li>
                <li>Если клик был на нужном элементе, мы извлекаем необходимую информацию (например, URL большого
                    изображения из атрибута <code>data-source</code>).</li>
                <li>Также важно отменить стандартное действие браузера для ссылки (переход по <code>href</code>) с
                    помощью <code>event.preventDefault()</code>.</li>
            </ol>
            <p>Пример кода (добавить в <code>gallery.js</code>, после кода создания разметки):</p>
            <div class="code-block">
                <pre><code class="language-javascript">// ===== Делегирование событий на галерее =====
// (Этот код должен быть в gallery.js)
// console.log("===== 5. Делегирование событий =====");

// Снова находим контейнер галереи (если он не был сохранен ранее).
// Лучше сохранить его в переменную один раз в начале скрипта.
const galleryDelegateContainer = document.querySelector('.gallery');

// Проверяем, найден ли контейнер.
if (galleryDelegateContainer) {
    // Добавляем ОДИН слушатель события 'click' на весь контейнер &lt;ul&gt;.
    galleryDelegateContainer.addEventListener('click', (event) => {
        // event - объект события, содержит информацию о клике.

        // 1. Отменяем действие по умолчанию для клика по ссылке (переход по href).
        event.preventDefault();
        // console.log("\n   [Click Listener] Произошел клик внутри галереи.");

        // 2. Определяем элемент, на который кликнули (event.target).
        // Используем closest('.gallery-image'), чтобы найти само изображение,
        // даже если клик пришелся на ссылку (&lt;a&gt;) вокруг него.
        const targetImage = event.target.closest('.gallery-image');

        // Если клик был не по изображению, выходим из обработчика.
        if (!targetImage) {
            // console.log("   Клик был не по изображению (.gallery-image). Игнорируем.");
            return;
        }

        // 4. Получаем URL большого изображения из data-атрибута 'source' у изображения.
        // dataset.source соответствует атрибуту data-source в HTML.
        const largeImageURL = targetImage.dataset.source;

        // 5. Если URL получен, выводим его в консоль (пока что).
        if (largeImageURL) {
            console.log(`   Клик по изображению! URL большого изображения: ${largeImageURL}`);
            // На следующем этапе здесь будет код для открытия модального окна.
        } else {
            console.warn("   Не найден атрибут data-source у изображения.");
        }
    });
    // console.log("   Слушатель кликов (делегирование) добавлен на .gallery.");

} else {
    console.error("Ошибка: Контейнер .gallery не найден для добавления слушателя событий!");
}
</code></pre>
                <button class="run-code" data-example="guide-delegation">Запустить пример</button>
                <button class="copy-code">Скопировать код</button>
                <button class="toggle-code">Скрыть код</button>
                <div class="output"></div>
            </div>
            <p>Теперь, если вы откроете страницу в браузере и кликнете на любое изображение в галерее, в консоли
                разработчика должно появиться сообщение с URL большого изображения.</p>
        </section>

        <section id="gallery-basiclightbox" class="fade-in visible">
            <h3>6. Подключение и использование basicLightbox</h3>
            <p>Для отображения полноразмерного изображения при клике мы используем библиотеку
                <code>basicLightbox</code>. Мы уже подключили ее CSS и JS файлы через CDN в секции
                <code>&lt;head&gt;</code> и перед закрывающим <code>&lt;/body&gt;</code> соответственно.
            </p>
            <p>Теперь нужно обновить наш обработчик кликов в <code>gallery.js</code>:</p>
            <ol>
                <li>Вместо вывода URL в консоль, мы будем создавать экземпляр модального окна с помощью
                    <code>basicLightbox.create()</code>.
                </li>
                <li>Внутрь модального окна мы передадим HTML-строку с тегом <code>&lt;img&gt;</code>, у которого
                    <code>src</code> будет равен URL большого изображения (<code>largeImageURL</code>), а
                    <code>alt</code> - описанию изображения.
                </li>
                <li>Вызовем метод <code>.show()</code> у созданного экземпляра, чтобы открыть модальное окно.</li>
                <li>(Опционально, но рекомендуется) Добавим слушатель события `keydown` на `document` для закрытия
                    модального окна по клавише `Escape`. Важно не забыть удалить этот слушатель после закрытия окна,
                    чтобы он не накапливался.</li>
            </ol>
            <p>Финальный код для файла <code>gallery.js</code>:</p>
            <div class="code-block">
                <pre><code class="language-javascript">// ===== Финальный код для gallery.js =====
// console.log("===== Финальная версия gallery.js =====");

// --- 1. Массив данных для галереи (Киберпанк) ---
const images = [
  { preview: 'https://placehold.co/600x400/000020/00ffff?text=Neon+Cityscape+Prev', original: 'https://placehold.co/1280x720/000020/00ffff?text=Neon+Cityscape', description: 'Неоновый городской пейзаж под дождем' },
  { preview: 'https://placehold.co/600x400/1a001a/ff00ff?text=Cyborg+Alley+Prev', original: 'https://placehold.co/1280x720/1a001a/ff00ff?text=Cyborg+Alley', description: 'Киборг в темном переулке' },
  { preview: 'https://placehold.co/600x400/202020/00ff00?text=Data+Stream+Prev', original: 'https://placehold.co/1280x720/202020/00ff00?text=Data+Stream', description: 'Поток цифровых данных' },
  { preview: 'https://placehold.co/600x400/0d0d0d/ff4500?text=Rainy+Streets+Prev', original: 'https://placehold.co/1280x720/0d0d0d/ff4500?text=Rainy+Streets', description: 'Дождливые улицы мегаполиса ночью' },
  { preview: 'https://placehold.co/600x400/001f3f/7fdbff?text=Hologram+Ad+Prev', original: 'https://placehold.co/1280x720/001f3f/7fdbff?text=Hologram+Ad', description: 'Голографическая реклама в городе будущего' },
  { preview: 'https://placehold.co/600x400/301934/f0e68c?text=Tech+Noir+Prev', original: 'https://placehold.co/1280x720/301934/f0e68c?text=Tech+Noir', description: 'Атмосфера тек-нуара' },
  { preview: 'https://placehold.co/600x400/4b0082/ee82ee?text=Cyberpunk+Rider+Prev', original: 'https://placehold.co/1280x720/4b0082/ee82ee?text=Cyberpunk+Rider', description: 'Гонщик на футуристическом байке' },
  { preview: 'https://placehold.co/600x400/111111/ffcc00?text=Glitch+Art+Prev', original: 'https://placehold.co/1280x720/111111/ffcc00?text=Glitch+Art', description: 'Абстрактный глитч-арт' },
  { preview: 'https://placehold.co/600x400/003366/ccffff?text=Android+Dream+Prev', original: 'https://placehold.co/1280x720/003366/ccffff?text=Android+Dream', description: 'Задумчивый андроид' },
];

// --- 2. Поиск контейнера галереи ---
const galleryContainer = document.querySelector('.gallery');

// --- 3. Создание и добавление разметки галереи ---
if (galleryContainer) {
    // Создаем HTML-строку для всех элементов галереи.
    const galleryMarkup = images
      .map(({ preview, original, description }) => `
        &lt;li class="gallery-item"&gt;
          &lt;a class="gallery-link" href="${original}"&gt;
            &lt;img
              class="gallery-image"
              src="${preview}"
              data-source="${original}"
              alt="${description}"
            /&gt;
          &lt;/a&gt;
        &lt;/li&gt;
      `)
      .join('');
    // Вставляем разметку в контейнер.
    galleryContainer.insertAdjacentHTML('beforeend', galleryMarkup);
    // console.log("Разметка галереи создана.");

    // --- 4. Делегирование и открытие модального окна basicLightbox ---
    // Добавляем слушатель клика на контейнер.
    galleryContainer.addEventListener('click', (event) => {
        // Отменяем стандартное действие ссылки.
        event.preventDefault();
        // Ищем ближайший элемент .gallery-image, по которому кликнули.
        const targetImage = event.target.closest('.gallery-image');

        // Если клик был не по изображению, выходим.
        if (!targetImage) return;

        // Получаем URL большого изображения и описание.
        const largeImageURL = targetImage.dataset.source;
        const imageDescription = targetImage.alt;

        // Если URL не найден, выходим.
        if (!largeImageURL) return;

        // Объявляем переменную для хранения экземпляра basicLightbox.
        let instance = null;

        // Объявляем функцию-обработчик для нажатия Escape.
        const onEscKeyPress = (e) => {
            // Проверяем клавишу и видимость окна.
            if (e.key === 'Escape' &amp;&amp; instance &amp;&amp; instance.visible()) {
                // console.log("Нажат Escape, закрываем модальное окно.");
                instance.close(); // Закрываем окно.
            }
        };

        // Создаем экземпляр basicLightbox.
        instance = basicLightbox.create(`
            &lt;img src="${largeImageURL}" alt="${imageDescription}" width="1112" height="640"&gt;
        `, {
            // Опции:
            onShow: (instance) => {
                // При показе окна добавляем слушатель Esc.
                // console.log("Модальное окно открыто, добавлен слушатель Esc.");
                document.addEventListener('keydown', onEscKeyPress);
            },
            onClose: (instance) => {
                // При закрытии окна удаляем слушатель Esc.
                // console.log("Модальное окно закрыто, удален слушатель Esc.");
                document.removeEventListener('keydown', onEscKeyPress);
            }
        });

        // Показываем модальное окно.
        instance.show();
        // console.log(`Открыто модальное окно для: ${largeImageURL}`);
    });
    // console.log("Слушатель кликов с basicLightbox добавлен.");

} else {
    console.error("Ошибка: Контейнер .gallery не найден!");
}
</code></pre>
                <button class="copy-code">Скопировать финальный JS</button>
                <button class="toggle-code">Скрыть код</button>
            </div>
        </section>

        <div class="navigation-buttons">
            <a href="dom_summary.html" class="button">← Памятка по DOM</a>
            <a href="resources.html" class="button">Ресурсы →</a>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>© 2025 JavaScript: Полное руководство для изучения</p>
        </div>
    </footer>

    <button id="scroll-top" style="display: none;">↑</button>

    <script src="../main.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/basiclightbox@5.0.4/dist/basicLightbox.min.js"></script>
    <script src="../js/gallery.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

</body>

</html>
```

**2. Финальный JavaScript (`gallery.js`)**

Этот код нужно сохранить как `gallery.js` в папке `js`.


```javascript
// ===== Файл: js/gallery.js =====
// Содержит данные и логику для галереи изображений на странице gallery.html

// --- 1. Массив данных для галереи (Киберпанк) ---
// Используем плейсхолдеры с placehold.co для надежности
const images = [
{
// preview: ссылка на маленькое изображение (для отображения в сетке галереи)
preview: 'https://placehold.co/600x400/000020/00ffff?text=Neon+Cityscape+Prev',
// original: ссылка на большое изображение (для модального окна)
original: 'https://placehold.co/1280x720/000020/00ffff?text=Neon+Cityscape',
// description: текстовое описание изображения
description: 'Неоновый городской пейзаж под дождем',
},
{
preview: 'https://placehold.co/600x400/1a001a/ff00ff?text=Cyborg+Alley+Prev',
original: 'https://placehold.co/1280x720/1a001a/ff00ff?text=Cyborg+Alley',
description: 'Киборг в темном переулке',
},
{
preview: 'https://placehold.co/600x400/202020/00ff00?text=Data+Stream+Prev',
original: 'https://placehold.co/1280x720/202020/00ff00?text=Data+Stream',
description: 'Поток цифровых данных',
},
{
preview: 'https://placehold.co/600x400/0d0d0d/ff4500?text=Rainy+Streets+Prev',
original: 'https://placehold.co/1280x720/0d0d0d/ff4500?text=Rainy+Streets',
description: 'Дождливые улицы мегаполиса ночью',
},
{
preview: 'https://placehold.co/600x400/001f3f/7fdbff?text=Hologram+Ad+Prev',
original: 'https://placehold.co/1280x720/001f3f/7fdbff?text=Hologram+Ad',
description: 'Голографическая реклама в городе будущего',
},
{
preview: 'https://placehold.co/600x400/301934/f0e68c?text=Tech+Noir+Prev',
original: 'https://placehold.co/1280x720/301934/f0e68c?text=Tech+Noir',
description: 'Атмосфера тек-нуара',
},
{
preview: 'https://placehold.co/600x400/4b0082/ee82ee?text=Cyberpunk+Rider+Prev',
original: 'https://placehold.co/1280x720/4b0082/ee82ee?text=Cyberpunk+Rider',
description: 'Гонщик на футуристическом байке',
},
{
preview: 'https://placehold.co/600x400/111111/ffcc00?text=Glitch+Art+Prev',
original: 'https://placehold.co/1280x720/111111/ffcc00?text=Glitch+Art',
description: 'Абстрактный глитч-арт',
},
{
preview: 'https://placehold.co/600x400/003366/ccffff?text=Android+Dream+Prev',
original: 'https://placehold.co/1280x720/003366/ccffff?text=Android+Dream',
description: 'Задумчивый андроид',
},
];

// --- 2. Поиск контейнера галереи ---
// Находим элемент <ul class="gallery"> в документе один раз и сохраняем в переменную.
    const galleryContainer = document.querySelector('.gallery');

    // --- 3. Создание и добавление разметки галереи ---
    // Проверяем, найден ли контейнер, чтобы избежать ошибок, если HTML изменится.
    if (galleryContainer) {
    // Создаем HTML-строку для всех элементов галереи:
    // 1. map() проходит по каждому объекту в массиве 'images'.
    // 2. Деструктуризация { preview, original, description } извлекает нужные свойства из объекта.
    // 3. Шаблонная строка `` создает HTML для одного элемента <li>.
        // 4. join('') объединяет все строки
    <li> в одну большую HTML-строку.
        const galleryMarkup = images
        .map(({ preview, original, description }) => `
    <li class="gallery-item">
        <a class="gallery-link" href="${original}">
            <img class="gallery-image" src="${preview}" data-source="${original}" alt="${description}" />
        </a>
    </li>
    `)
    .join('');

    // Вставляем сгенерированную разметку внутрь контейнера .gallery.
    // Используем insertAdjacentHTML для большей гибкости, чем innerHTML.
    // 'beforeend' вставляет разметку перед закрывающим тегом
</ul>.
galleryContainer.insertAdjacentHTML('beforeend', galleryMarkup);
console.log("Разметка галереи создана и добавлена в DOM.");

// --- 4. Делегирование и открытие модального окна basicLightbox ---
// Добавляем ОДИН слушатель события 'click' на весь контейнер <ul>.
    galleryContainer.addEventListener('click', (event) => {
    // event - объект события.

    // Предотвращаем стандартное действие браузера для ссылки (переход по href).
    event.preventDefault();

    // Определяем элемент, на который кликнули (event.target).
    // Используем closest('.gallery-image'), чтобы найти само изображение,
    // даже если клик пришелся на ссылку или другой элемент внутри <li>.
        const targetImage = event.target.closest('.gallery-image');

        // Если клик был не по изображению (или элементу внутри него), выходим из функции.
        if (!targetImage) {
        // console.log("Клик был не по изображению (.gallery-image). Игнорируем.");
        return;
        }

        // Получаем URL большого изображения из data-атрибута 'source'.
        const largeImageURL = targetImage.dataset.source;
        // Получаем описание из атрибута 'alt'.
        const imageDescription = targetImage.alt;

        // Если URL не найден (атрибут data-source отсутствует), выходим.
        if (!largeImageURL) {
        console.warn("Не найден атрибут data-source у изображения.");
        return;
        }

        // --- Создание и показ модального окна basicLightbox ---
        // Объявляем переменную для хранения экземпляра модального окна.
        let instance = null;

        // Объявляем функцию-обработчик для нажатия клавиши Escape.
        // Она должна быть объявлена здесь, чтобы иметь доступ к 'instance'.
        const onEscKeyPress = (e) => {
        // Проверяем, что нажата клавиша 'Escape' и модальное окно видимо.
        if (e.key === 'Escape' && instance && instance.visible()) {
        // console.log("Нажат Escape, закрываем модальное окно.");
        instance.close(); // Закрываем модальное окно.
        }
        };

        // Создаем экземпляр модального окна с помощью basicLightbox.create().
        // Первый аргумент - HTML-строка содержимого окна.
        // Второй аргумент - объект с опциями.
        instance = basicLightbox.create(`
        <img src="${largeImageURL}" alt="${imageDescription}" width="1112" height="640">
        `, {
        // Опция onShow: функция, которая выполнится ПЕРЕД показом окна.
        onShow: (instance) => {
        // console.log("Модальное окно открывается. Добавляем слушатель Esc.");
        // Добавляем слушатель нажатия клавиш на весь документ.
        document.addEventListener('keydown', onEscKeyPress);
        },
        // Опция onClose: функция, которая выполнится ПОСЛЕ закрытия окна.
        onClose: (instance) => {
        // console.log("Модальное окно закрыто. Удаляем слушатель Esc.");
        // Удаляем слушатель нажатия клавиш, чтобы он не висел без дела.
        document.removeEventListener('keydown', onEscKeyPress);
        }
        });

        // Показываем созданное модальное окно.
        instance.show();
        // console.log(`Открыто модальное окно для: ${largeImageURL}`);
        });
        console.log("Слушатель кликов с basicLightbox добавлен на .gallery.");

        } else {
        // Сообщение об ошибке, если контейнер .gallery не найден.
        console.error("Ошибка: Контейнер .gallery не найден на странице!");
        }

        // --- Конец файла gallery.js ---